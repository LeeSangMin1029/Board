extends ../components/partial/layout.pug
include ../components/form/formChildNode.pug

block append style
  link(rel="stylesheet" type="text/css" href="/static/css/paginate.css")
  
block append head
  script(defer type="module" src="/static/js/post/RenderPosts.js")

block content
  .main-container
    #index-header
      h4 Board
      #search-contents
        label(for="serachText"): h4 search
        form(method="POST")
          fieldset
            +userInputTag("input", "serachText", "searchText", "uit", "input text")
            button.btn(type="submit") search
    table
      thead
        tr
          th Title
          th Author
          th CreatedAt
      +tablebody(posts)
    - if(count)
      +pagination()
    - else
      p There are no posts please create it
    - if(isAuthenticated)
      a.btn(href="/posts/new") New

mixin pagination()
  div.paginate: div.page-wrap
    - for (let i = 1; i <= count; i++)
      - if(currentPage==i)
        button.page.current-page(href=`/posts/page/${i}`)
          em.num-page= i
      - else
        button.page(href=`/posts/page/${i}`)
          em.num-page= i

mixin tablebody(posts)
  tbody#tbody-posts
    each post in posts
      tr
        td: a.post-link.txt-hidden(href=`/posts/${post._id}`)= `${post.title}`
        td= `${post.author.name}`
        td= `${post.createdAt}`